<!DOCTYPE html>
<html>
  <head>
    <title>Test :Ajouter une chaîne hôtelière et un bureau</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.0.2/css/bootstrap.min.css">
  </head>
  <body>
    <div class="container mt-5">
      <h1>Ajouter une chaîne hôtelière et un bureau</h1>
      <form id="addChainehoteliereAndBureauForm">
        <div class="form-group">
          <label for="nomChaine">Nom de la chaîne :</label>
          <input type="text" class="form-control" id="nomChaine" name="nomChaine" required>
        </div>
        <div class="form-group">
          <label for="nombreHotel">Nombre d'hôtels :</label>
          <input type="number" class="form-control" id="nombreHotel" name="nombreHotel" required>
        </div>
        <div class="form-group">
          <label for="rue">Rue :</label>
          <input type="text" class="form-control" id="rue" name="rue" required>
        </div>
        <div class="form-group">
          <label for="codePostal">Code postal :</label>
          <input type="text" class="form-control" id="codePostal" name="codePostal" required>
        </div>
        <div class="form-group">
          <label for="ville">Ville :</label>
          <input type="text" class="form-control" id="ville" name="ville" required>
        </div>
        <div class="form-group">
          <label for="email">Email :</label>
          <input type="email" class="form-control" id="email" name="email" required>
        </div>
        <div class="form-group">
          <label for="numeroTel">Numéro de téléphone :</label>
          <input type="tel" class="form-control" id="numeroTel" name="numeroTel" required>
        </div>
        <button type="submit" id="addChainehoteliereAndBureauBtn" class="btn btn-success m-1">Ajouter</button>

      </form>
      <button   class="btn btn-primary m-1 randomBtn">Random</button>

    </div>
    <div class="container">
<div class="row justify-content-center align-items-center g-2">
<!-- HTML Form -->
<form id="addbureauchainehoteliere-form">
    <div class="form-group">
      <label for="chainehoteliere-dropdown">Sélectionnez une chaîne hôtelière :</label>
      <select class="form-control" id="chainehoteliere-dropdown" name="chainehoteliere"></select>
    </div>
    <div class="form-group">
      <label for="rue-input">Rue :</label>
      <input type="text" class="form-control" id="rue-input" name="rue" required>
    </div>
    <div class="form-group">
      <label for="codepostal-input">Code postal :</label>
      <input type="text" class="form-control" id="codepostal-input" name="codePostal" required>
    </div>
    <div class="form-group">
      <label for="villebureauinput">Ville :</label>
      <input type="text" class="form-control villebureauinput" id="villebureauinput" name="ville" required>
    </div>
    <div class="form-group">
      <label for="email-input">Email :</label>
      <input type="email" class="form-control" id="email-input" name="email" required>
    </div>
    <div class="form-group">
      <label for="numerotel-input">Numéro de téléphone :</label>
      <input type="tel" class="form-control" id="numerotel-input" name="numeroTel" required>
    </div>

    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
  <button   class="btn btn-primary m-1 randomBtnbureau">Random</button>
  
  
</div>    </div>
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
      $(document).ready(() => {
        $('#addChainehoteliereAndBureauForm').submit((event) => {
          event.preventDefault(); // Empêche le formulaire de se soumettre normalement
  
          $.post('http://localhost:3000/add-chainehoteliere-bureau', {
            nomChaine: $('#nomChaine').val(),
            nombreHotel: $('#nombreHotel').val(),
            rue: $('#rue').val(),
            codePostal: $('#codePostal').val(),
            ville: $('#ville').val(),
            email: $('#email').val(),
            numeroTel: $('#numeroTel').val()
          }).done((data) => {
            alert('Ajout effectué !');
          }).fail((err) => {
            console.error('Erreur lors de l\'ajout :', err);
            alert('Erreur lors de l\'ajout.');
          });
          




          
        });
      });
    </script>

<script>
    $(document).ready(() => {
      $('.randomBtn').click(() => {
        // Appelle l'API Random User pour générer des données aléatoires
        $.ajax({
          url: 'https://randomuser.me/api/',
          dataType: 'json',
          success: (data) => {
            const randomUser = data.results[0];
            console.log(randomUser)
            // Remplit les champs du formulaire avec les données aléatoires
            $('#nomChaine').val(randomUser.name.first + ' ' + randomUser.name.last);
            $('#nombreHotel').val(0);
            $('#rue').val(randomUser.location.street.number + ' ' + randomUser.location.street.name);
            $('#codePostal').val(randomUser.location.postcode);
            $('#ville').val(randomUser.location.city);
            $('#email').val(randomUser.email);
            $('#numeroTel').val(randomUser.phone);
          },
          error: (err) => {
            console.error('Erreur lors de l\'appel à l\'API :', err);
            alert('Erreur lors de la génération de données aléatoires.');
          }







          
        });
        

      });

    });
    $(document).ready(() => {
      $('.randomBtnbureau').click(() => {
        // Appelle l'API Random User pour générer des données aléatoires
        $.ajax({
          url: 'https://randomuser.me/api/',
          dataType: 'json',
          success: (data) => {
            const randomUser = data.results[0];
            //console.log(randomUser)
            // Remplit les champs du formulaire avec les données aléatoires
            $('#nomChaine').val(randomUser.name.first + ' ' + randomUser.name.last);
            $('#rue-input').val(randomUser.location.street.number + ' ' + randomUser.location.street.name);
            $('#codepostal-input').val(randomUser.location.postcode);
            $('#villebureauinput').val(randomUser.location.city);
            $('#email-input').val(randomUser.email);
            $('#numerotel-input').val(randomUser.phone);
          },
          error: (err) => {
            console.error('Erreur lors de l\'appel à l\'API :', err);
            alert('Erreur lors de la génération de données aléatoires.');
          }







          
        });

      });

    });
  </script>
    <div class="container mt-5">
        <h1>Liste des chaînes hôtelières et leurs bureaux</h1>
        <div id="chainesHoteleresList" class="mt-4"></div>
      </div>
    <script>
    $(document).ready(() => {
  const chainesHoteleresList = $('#chainesHoteleresList');

  function getChainesAndBureaux() {
    return new Promise((resolve, reject) => {
      const url = 'http://localhost:3000/chaines-et-bureaux';
      $.get(url)
        .done((data) => resolve(data))
        .fail((err) => reject(err));
    });
  }

  function renderList(chaines) {
    const listGroup = $('<ul>').addClass('list-group');
    chaines.forEach((chaine) => {
       // console.log(chaine)
      const nomChaine = chaine.nomChaine;
      const nombrehotel = chaine.nombrehotel;    
      const listGroupItem = $('<li>').addClass('list-group-item m-2 rounded');
      const title = $('<h5>').text(nomChaine).appendTo(listGroupItem);
      const subtitle = $('<h6>').text(`Nombre d'hôtels: ${nombrehotel}`).appendTo(listGroupItem);

      const list = $('<ul>').addClass('list-group mt-2');
        const rue = chaine.rue;
        const codePostal = chaine.codePostal;
        const ville = chaine.ville;
        const email = chaine.email;
        const numeroTel = chaine.numeroTel;

        const listGroupItemBureau = $('<li>').addClass('list-group-item');
        const titleBureau = $('<h6>').text('Bureau').appendTo(listGroupItemBureau);
        const subtitleBureau = $('<p>').addClass('mb-1').text(`${rue}, ${codePostal} ${ville}`).appendTo(listGroupItemBureau);
        $('<p>').addClass('mb-1').text(`Email: ${email}`).appendTo(listGroupItemBureau);
        $('<p>').addClass('mb-1').text(`Numéro de téléphone: ${numeroTel}`).appendTo(listGroupItemBureau);

        list.append(listGroupItemBureau);
        

      listGroupItem.append(list);
      listGroup.append(listGroupItem);
    });

    chainesHoteleresList.empty().append(listGroup);
  }

  function executeScript() {
    getChainesAndBureaux()
      .then((chaines) => {
        renderList(chaines);
      })
      .catch((err) => {
        console.error('Erreur lors de la récupération des données :', err);
        chainesHoteleresList.text('Erreur lors de la récupération des données.');
      });
  }

  executeScript();

  setInterval(() => {
    executeScript();
  }, 200000);

});

// jQuery code to populate the dropdown list with chaines hotellieres
$(document).ready(function() {
  // Get the list of chaines hotellieres from the server using AJAX
  $.get('http://localhost:3000/chaines-hotellieres', function(data) {
    // Loop through the array of chaines hotellieres and append them to the dropdown list

    for (var i = 0; i < data.length; i++) {
      var chainehoteliere = data[i];
      $('#chainehoteliere-dropdown').append($('<option>', {
        value: chainehoteliere.idchaine,
        text: chainehoteliere.nom
      }));
    }
  });
  
  // Handle form submission
  $(document).ready(() => {
  $('#addbureauchainehoteliere-form').submit((event) => {
    event.preventDefault(); // Empêche le formulaire de se soumettre normalement

    $.post('http://localhost:3000/bureau', {
      chainehoteliere: $('#chainehoteliere-dropdown').val(),
      rue: $('#rue-input').val(),
      codePostal: $('#codepostal-input').val(),
      ville: $('#villebureauinput').val(),
      email: $('#email-input').val(),
      numeroTel: $('#numerotel-input').val()
    }).done((data) => {
        console.log(data)
      alert('Ajout effectué !');
    }).fail((err) => {
      console.error('Erreur lors de l\'ajout :', err);
      alert('Erreur lors de l\'ajout.');
    });
  });
});


});


    </script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


  </body>
  
</html>
